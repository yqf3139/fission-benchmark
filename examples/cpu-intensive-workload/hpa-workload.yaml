version: v1
metadata:
  name: cpu-intensive-workload
  desc: Workload for testing if fission-benchmark works
specs:
  - function: cpu-intensive
    workload: long-long-workload
functions:
  - metadata:
      name: cpu-intensive
    environment:
      name: node
    file: user.js
    controls:
      - metadata:
          name: control1
          desc: a single node.js deployment behind k8s service
        endpoint: "http://127.0.0.1:31321/"
      - metadata:
          name: control2
          desc: 5 static replicas
        endpoint: "http://127.0.0.1:31322/"
      - metadata:
          name: control3
          desc: 5 hpa replicas
        endpoint: "http://127.0.0.1:31323/"
workloads:
  - metadata:
      name: long-long-workload
    kind: warm # cold, warm
    number: 3000
    concurrence: 60
    timeout: 60
    qps: 0
    verbose: false
    disableKeepAlive: true
    trigger:
      kind: Http
      spec:
        method: POST
        data: "{\"ms\":100}"
